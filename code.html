<!DOCTYPE html>
<head>
  <title>202055582 이지은</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <style>
  * {
    box-sizing: border-box;
  }

  body {
    margin: 0;
    font-family: Arial, Helvetica, sans-serif;
  }

  /* Style the side navigation */
  .sidenav {
    height: 100%;
    width: 200px;
    position: fixed;
    z-index: 1;
    top: 0;
    left: 0;
    background-color: #001a46;
    overflow-x: hidden;
    float:right;
  }


  /* Side navigation links */
  .sidenav a {
    color: white;
    padding: 16px;
    text-decoration: none;
    display: block;
  }

  /* Change color on hover */
  .sidenav a:hover {
    background-color: #ddd;
    color: #001a46;
  }

  /* Style the content */
  .content {
    margin-left: 200px;
    padding-left: 20px;
  }
  /*section의 height는 auto로 설정*/
  #s2{                              
    margin-left: 200px;
    padding-left: 20px;
    width: 85%;
    height: auto;    
    border: solid 3px #3DB7CC;
    box-sizing: border-box;
  }
  #s3{
    margin-left: 200px;
    padding-left: 20px;
    width: 85%;
    height: auto;
    border: solid 3px #3DB7CC;
    box-sizing: border-box;
  }
  #s1{
    margin-left: 200px;
    padding-left: 20px;
    width: 85%;
    height: auto;
    border: solid 3px #3DB7CC;
    box-sizing: border-box;
  }
  /*각 style 설정*/
  h1{
        width: 96%;
        padding: 16px;
        text-align:center;
        background-color:#94c4d2;
        margin:0px;
  }
  h2{
      color: navy;
      padding: 0px;
  }
  h3{
        width: 96%;
        text-align:center;
        background-color:#d7e1e9;
        margin: 0px;
  }

  footer{
        width: 100%;
        padding: 13px;
        text-align:center;
        background-color:#94c4d2;
            }
  /*두번째 section의 table style 설정*/
  #tbl1{
      border:2px solid black;
      border-top-left-radius:1em; 
      border-top-right-radius:1em; 
      border-bottom-right-radius:1em;
      border-bottom-left-radius:1em;
  }
  #tr1{
      border: 1px solid black;
  }
  #td1{
      border: 1px solid black;
      text-align: center;
      background-color : #d7e1e9;
      
  }
  #td17{
      border: 1px solid black;
      text-align: center;
      
  }
  #th122{
      border: 1px solid black;
      background-color: #94c4d2;
     
  }
  #th1225{
    border: 1px solid black;
    background-color: #94c4d2;
    border-top-left-radius:1em;
  }
  #th1226{
    border: 1px solid black;
    background-color: #94c4d2;
    border-top-right-radius:1em; 
  }
  #td155{
    border: 1px solid black;
    text-align: center;
    background-color : #d7e1e9;
    border-bottom-left-radius:1em;
  }
  #td1555{
    border: 1px solid black;
    text-align: center;
    background-color : #d7e1e9;
    border-bottom-right-radius:1em;
  }
  </style>
</head>
<body>

<div class="sidenav">
  <a href="#s2">오늘의 날씨</a>
  <a href="#s3">오늘의 날씨-추가설명</a>
  <a href="#s1">오늘의 환율</a>
  <a href="#">top</a>
</div>

<div class="content">
  <h1>오늘의 정보 조회하기</h1>  
  <h3>오늘의 정보에 대한 웹페이지입니다.</h3>
</div>

<section id='s2'>
    <h2>오늘의 날씨 정보 조회하기</h2>
    <h5>실황 정보를 알려줍니다. 정보를 얻기 위해서 원하는 값을 입력하고 버튼{확인하기}를 클릭하세요.</h5>
<form name=myform>
        <label for='base_date'> 발표일자:</label>
        <input type="text" id='base_date' name='base_date' value='20200619'>
        <label for='base_time'> 발표시각:</label>
        <input type="text" id='base_time' name='base_time' value='1800'>
        <label for='nx'> 예보지점 X 좌표:</label>
        <input type="text" id='nx' name='nx' value='100'>
        <label for='ny'> 예보지점 Y 좌표:</label>
        <input type="text" id='ny' name='ny' value='100'></br>
        <label for='dataType'> 응답자료형식:</label>
        <input type="text" id='dataType' name='dataType' value='json'><br>
</form>
<form><input type="button" value="확인하기" onclick="displayResponse()"><br></form>
<script>
    var xhr1 = new XMLHttpRequest();
    xhr1.withCredentials = true;
    xhr1.addEventListener("readystatechange", function () {
        if (this.readyState === 4) {
            document.getElementById("tbl0").style.border= "2px solid #00427d";
            console.log(this.responseText);
            var parsed = JSON.parse(this.responseText);   //파싱
            var tbl = document.getElementById('tbl0');
            document.getElementById("th1").style.border= " 2px solid #0186ba";   //테이블 header의 style 설정
            document.getElementById("th1").style.backgroundColor= " #76bfba";
            document.getElementById("th2").style.border= " 2px solid #0186ba";
            document.getElementById("th2").style.backgroundColor= " #76bfba";
            document.getElementById("th3").style.border= " 2px solid #0186ba";
            document.getElementById("th3").style.backgroundColor= " #76bfba";
            document.getElementById("th4").style.border= " 2px solid #0186ba";
            document.getElementById("th4").style.backgroundColor= " #76bfba";
            document.getElementById("th5").style.border= " 2px solid #0186ba";
            document.getElementById("th5").style.backgroundColor= " #76bfba";
            document.getElementById("th6").style.border= " 2px solid #0186ba";
            document.getElementById("th6").style.backgroundColor= " #76bfba";
            document.getElementById('th1').innerHTML = "발표일자";             //값 입력
            document.getElementById('th2').innerHTML = "발표시각";
            document.getElementById('th3').innerHTML = "자료구분코드";
            document.getElementById('th4').innerHTML = "예보지점 X 좌표";
            document.getElementById('th5').innerHTML = "예보지점 Y 좌표";
            document.getElementById('th6').innerHTML = "실황 값";
            for (i in parsed.response.body.items.item) {
                var cur11 = parsed.response.body.items.item[i].baseDate;      //자료 정리
                var cur12 = parsed.response.body.items.item[i].baseTime;
                var cur13 = parsed.response.body.items.item[i].category;
                var cur14 = parsed.response.body.items.item[i].nx;
                var cur15 = parsed.response.body.items.item[i].ny;
                var cur16 = parsed.response.body.items.item[i].obsrValue;
                var tr = document.createElement('tr');                       //tr을 추가하고 같은 열에 td추가
                var td11 = document.createElement('td');
                var td12 = document.createElement('td');
                var td13 = document.createElement('td');
                var td14 = document.createElement('td');
                var td15 = document.createElement('td');
                var td16 = document.createElement('td');
                td11.style.border="1px solid black";                   //td 스타일 설정
                td11.style.textAlign="center";
                td11.style.backgroundColor="#ccdcdb"
                td12.style.border="1px solid black";
                td12.style.textAlign="center";
                td13.style.border="1px solid black";
                td13.style.textAlign="center";
                td13.style.backgroundColor="#dfe8e8"
                td14.style.border="1px solid black";
                td14.style.textAlign="center";
                td15.style.border="1px solid black";
                td15.style.textAlign="center";
                td15.style.backgroundColor="#dfe8e8"
                td16.style.border="1px solid black";
                td16.style.textAlign="center";
                td11.innerHTML = JSON.stringify(cur11).replace(/"/gi,"");           //td에 각 값 입력
                td12.innerHTML = JSON.stringify(cur12).replace(/"/gi,"");
                td13.innerHTML = JSON.stringify(cur13).replace(/"/gi,"");
                td14.innerHTML = JSON.stringify(cur14).replace(/"/gi,"");
                td15.innerHTML = JSON.stringify(cur15).replace(/"/gi,"");
                td16.innerHTML = JSON.stringify(cur16).replace(/"/gi,"");
                tr.appendChild(td11);                                            //각 td를 tr 에 추가
                tr.appendChild(td12);
                tr.appendChild(td13);
                tr.appendChild(td14);
                tr.appendChild(td15);
                tr.appendChild(td16);
                tbl.appendChild(tr);
            }}
    
    });
    
    function displayResponse(){
        if (myform.nx.value.length==0 | myform.ny.value.length==0|myform.base_time.value.length==0|myform.base_date.value.length==0|myform.dataType.value.length==0){
            alert( "input data가 입력되지 않았습니다.");          //에러처리- 빠진 입력값이 있을때
            if (myform.nx.value.length==0){
            myform.nx.focus();
            }
            if (myform.ny.value.length==0){
            myform.ny.focus();
            }
            if (myform.base_time.value.length==0){
            myform.base_time.focus();
            }
            if (myform.base_date.value.length==0){
            myform.base_date.focus();
            }
            if (myform.dataType.value.length==0){
            myform.dataType.focus();
            }
            return;
        };
        if (myform.base_date.value.length<8){          //에러처리- 입력값의 길이가 일치하지 않을 때 
            alert("base_date length error");
            myform.base_date.focus();
            return;
        };
        if (myform.base_time.value.length<4){
            alert( "base_time length error");
            myform.base_time.focus();
            return;
        };
        var url1 = "http://localhost:3000/weather"

        var base_date = document.getElementById('base_date').value;
        var base_time = document.getElementById('base_time').value;
        var nx = document.getElementById('nx').value;
        var ny = document.getElementById('ny').value;
        var dataType = document.getElementById('dataType').value;                //url 설정

        url1 = url1 + "?" + "base_date="+base_date +"&base_time="+base_time +"&nx="+nx +"&ny="+ny +"&dataType="+dataType 

        xhr1.open("GET", url1);
        xhr1.send();
    }
    
</script>

<table id="tbl0" style= "width: 80%">
    <tr>
        <th id= "th1" style= "text-align: center"></th>              
        <th id= "th2" style= "text-align: center"></th>
        <th id= "th3" style= "text-align: center"></th>
        <th id= "th4" style= "text-align: center"></th>
        <th id= "th5" style= "text-align: center"></th>
        <th id= "th6" style= "text-align: center"></th>
    </tr>
</table>

<p id="raw_data"></p>


</section>
<section id= "s3">
    <h2>오늘의 날씨 정보에 대한 추가 설명</h2>
    <h5>오늘의 날씨 정보 중 자료 구분 코드에 대한 설명입니다. </h5>
    <script>
        function show() {
            var str = "" ;
            str = form1.txt1.value;        //입력 값 가져오기
            var result = ""
            if (str.length>3){
                alert("입력값 길이는 3입니다.")
                form1.txt1.focus()
            }
            if (str==""|str=="T1H"){
                str="T1H"
                result= "항목명 : 기온 , 단위 : ℃"               //해당 입력값에 대한 정보 보기
            }
            if (str=="RN1"){
                result= "항목명 : 1시간 강수량 , 단위 : mm"
            }
            if (str=="UUU"){
                result= "항목명 : 동서바람성분 , 단위 : m/s"
            }
            if (str=="VVV"){
                result= "항목명 : 남북바람성분 , 단위 : m/s"
            }
            if (str=="REH"){
                result= "항목명 : 습도 , 단위 : %"
            }
            if (str=="PTY"){
                result= "항목명 : 강수형태 , 단위 : 코드값"
            }
            if (str=="VEC"){
                result= "항목명 : 풍향 , 단위 : 0"
            }
            if (str=="WSD"){
                result= "항목명 : 풍속 , 단위 : 1"
            }
            //document.getElementById("msg").innerHTML = str+"  ->  "+result;   //jQuery사용
            $("#msg").text(str+"  ->  "+result);
            msg.style.border= "2px solid red";
            msg.style.padding= "5px";
            msg.style.width= "30%";
            
        }
    </script>
    <form name="form1">
        <label> 항목별 검색하기</label>
        <input type="text" name="txt1" id="txt1" placeholder="T1H">
        <input type="button" value="확인" onclick="show();">
        <input type="reset" value="취소">
    </form>
    <div id="msg">
    </div>
    <table id="tbl1" style="width: 50%">            
        <tr id= tr1>
            <th id= th1225>항목값</th>
            <th id= th122>항목명</th>
            <th id= th1226>단위</th>
        </tr>
        <tr id= tr1>
            <td id= td17>T1H</td>
            <td id= td17>기온</td>
            <td id= td17>℃</td>
        </tr>
        <tr id= tr1>
            <td id= td1>RN1</td>
            <td id= td1>1시간 강수량</td>
            <td id= td1>mm</td>
        </tr>
        <tr id= tr1>
            <td id= td17>UUU</td>
            <td id= td17>동서바람성분</td>
            <td id= td17>m/s</td>
        </tr>
        <tr id= tr1>
            <td id= td1>VVV</td>
            <td id= td1>남북바람성분</td>
            <td id= td1>m/s</td>
        </tr>
        <tr id= tr1>
            <td id= td17>REH</td>
            <td id= td17>습도</td>
            <td id= td17>%</td>
        </tr>
        <tr id= tr1>
            <td id= td1>PTY</td>
            <td id= td1>강수형태</td>
            <td id= td1>코드값</td>
        </tr>
        <tr id= tr1>
            <td id= td17>VEC</td>
            <td id= td17>풍향</td>
            <td id= td17>0</td>
        </tr>
        <tr id= tr1>
            <td id= td155>WSD</td>
            <td id= td1>풍속</td>
            <td id= td1555>1</td>
        </tr>
    </table>
</section>

<section id="s1">
    <h2>오늘의 환율 정보</h2>
    <p>최신 환율 정보를 제공합니다. 정보를 확인하기 위해서는 버튼을 누르세요.</p>
    <form><input type="button" value="확인하기" onclick="displayResponse1()"><br></form>
    
    <script>
        var xhr = new XMLHttpRequest();
        xhr.withCredentials = true;
        xhr.addEventListener("readystatechange", function () {
            if (this.readyState === 4) {
                document.getElementById("tbl01").style.border = "2px solid #00427d";
                console.log(this.responseText);
                var parsed = JSON.parse(this.responseText);
                document.getElementById("th11").style.border = " 2px solid #0186ba";       //th style 설정
                document.getElementById("th11").style.backgroundColor = " #76bfba";
                document.getElementById("th21").style.border = " 2px solid #0186ba";
                document.getElementById("th21").style.backgroundColor = " #76bfba";
                document.getElementById("th31").style.border = " 2px solid #0186ba";
                document.getElementById("th31").style.backgroundColor = " #76bfba";
                document.getElementById("th41").style.border = " 2px solid #0186ba";
                document.getElementById("th41").style.backgroundColor = " #76bfba";
                document.getElementById("th51").style.border = " 2px solid #0186ba";
                document.getElementById("th51").style.backgroundColor = " #76bfba";
                $("#th11").text("이름");    //document.getElementById('th11').innerHTML = "이름";    //jQuery사용
                $("#th21").text( "영어");    //document.getElementById('th21').innerHTML = "영어";
                $("#th31").text("한국어");   // document.getElementById('th31').innerHTML = "한국어";
                $("#th41").text("기준 시간");  //document.getElementById('th41').innerHTML = "기준 시간";
                $("#th51").text("가격");     //document.getElementById('th51').innerHTML = "가격";
                for (var i = 0; i < parsed.length; i++) {
                    var tbl = document.getElementById('tbl01');
                    var cur1 = parsed[i].en;                        //데이터 정리
                    var cur2 = parsed[i].date;
                    var cur3 = parsed[i].price;
                    var cur4 = parsed[i].name;
                    var cur5 = parsed[i].kr; 
                    var tr = document.createElement('tr');
                    var td11 = document.createElement('td');
                    var td12 = document.createElement('td');
                    var td13 = document.createElement('td');
                    var td14 = document.createElement('td');
                    var td15 = document.createElement('td');
                    td11.style.border = "1px solid #0186ba";           //td style 설정
                    td11.style.textAlign = "center";
                    td11.style.backgroundColor = "#ccdcdb";
                    td12.style.border = "1px solid #0186ba";
                    td12.style.textAlign = "center";
                    td13.style.border = "1px solid #0186ba";
                    td13.style.textAlign = "center";
                    td13.style.backgroundColor = "#dfe8e8";
                    td14.style.border = "1px solid #0186ba";
                    td14.style.textAlign = "center";
                    td15.style.border = "1px solid #0186ba";
                    td15.style.textAlign = "right";
                    td15.style.backgroundColor = "#dfe8e8";
                    td11.innerHTML = cur4;
                    td12.innerHTML = cur1;                              //td에 데이터값 추가
                    td13.innerHTML = cur5;
                    td14.innerHTML = cur2;
                    td15.innerHTML = cur3;
                    tr.appendChild(td11);                                //tr에 td 값 추가
                    tr.appendChild(td12);
                    tr.appendChild(td13);
                    tr.appendChild(td14);
                    tr.appendChild(td15);
                    tbl.appendChild(tr);                                // table에 tr추가
                }

            }
        });
        function displayResponse1() {
            xhr.open("GET", "http://localhost:3000/exchange");
            xhr.send();
        }
    </script>

    <table id="tbl01" style="width: 90%">
        <tr>
            <th id="th11" style="text-align: center"></th>
            <th id="th21" style="text-align: center"></th>
            <th id="th31" style="text-align: center"></th>
            <th id="th41" style="text-align: center"></th>
            <th id="th51" style="text-align: center"></th>
        </tr>
    </table>
    <p id="raw_data"></p>      
</section>
<footer>
     202055582 이지은             
</footer>
</body>
</html>